<!-- Crysandrea engine by Tyler Diaz (https://github.com/Pixeltweak/Crysandrea) --><noscript>
    <style type="text/css" media="screen">
        ul.avatar_tabs {
            display:none;
        }
        div#tab_glove {
            padding:0;
            background:white;
            overflow:hidden;
            border:5px solid #aaa;
            -moz-border-radius:6px;
        }
        div#tab_glove div span{
            float:left;
        }
        .multi_item {
            background:#ddd;
        }
        .multi_item ul {
            display:block;
            position:static;
            background:none;
            border:none;
            box-shadow:none;
            -moz-box-shadow:none;
        }
        .multi_item .pull_down {
            display:none;
        }
    </style>
</noscript>
<style type="text/css">
    .avatar_tabs {
        overflow:hidden;
    }
</style>
<style type="text/css" media="screen">
#save_avatar {
    display:block;
    margin:2px 2px 5px;
    text-align:center;
    font-size:16px;
    font-weight:bold;
    padding:8px 2px 7px 2px;
    border-radius:5px;
    -moz-border-radius:5px;
    -webkit-border-radius:5px;
    -moz-transition: none;
    -webkit-transition: none;
    -o-transition: color 0 ease-in;
    transition: none;
    background: #e7f7a5; /* Old browsers */
    background: -moz-linear-gradient(top,  #e7f7a5 2%, #d9f477 18%, #c2e24a 44%, #9ec415 87%, #87aa06 99%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(2%,#e7f7a5), color-stop(18%,#d9f477), color-stop(44%,#c2e24a), color-stop(87%,#9ec415), color-stop(99%,#87aa06)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top,  #e7f7a5 2%,#d9f477 18%,#c2e24a 44%,#9ec415 87%,#87aa06 99%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top,  #e7f7a5 2%,#d9f477 18%,#c2e24a 44%,#9ec415 87%,#87aa06 99%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top,  #e7f7a5 2%,#d9f477 18%,#c2e24a 44%,#9ec415 87%,#87aa06 99%); /* IE10+ */
    background: linear-gradient(top,  #e7f7a5 2%,#d9f477 18%,#c2e24a 44%,#9ec415 87%,#87aa06 99%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#e7f7a5', endColorstr='#87aa06',GradientType=0 ); /* IE6-9 */
    color:#354e12;
    font-family:helvetica;
    border:1px solid #88a462;
    -webkit-box-shadow: 0px 0px 0px 3px #e7ffc5;
    box-shadow: 0px 0px 0px 3px #e7ffc5;
}
#save_avatar:hover {
    background: #eaf9af; /* Old browsers */
    background: -moz-linear-gradient(top,  #eaf9af 2%, #dff787 18%, #ccea5e 44%, #bcea16 87%, #a9d606 99%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(2%,#eaf9af), color-stop(18%,#dff787), color-stop(44%,#ccea5e), color-stop(87%,#bcea16), color-stop(99%,#a9d606)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top,  #eaf9af 2%,#dff787 18%,#ccea5e 44%,#bcea16 87%,#a9d606 99%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top,  #eaf9af 2%,#dff787 18%,#ccea5e 44%,#bcea16 87%,#a9d606 99%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top,  #eaf9af 2%,#dff787 18%,#ccea5e 44%,#bcea16 87%,#a9d606 99%); /* IE10+ */
    background: linear-gradient(top,  #eaf9af 2%,#dff787 18%,#ccea5e 44%,#bcea16 87%,#a9d606 99%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#eaf9af', endColorstr='#a9d606',GradientType=0 ); /* IE6-9 */
    color:#49682b;
    border:1px solid #88a462;
    text-decoration:none;
}
#save_avatar:active {
    background: #7b9a0c; /* Old browsers */
    background: -moz-linear-gradient(top,  #7b9a0c 1%, #89a818 13%, #abd026 91%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(1%,#7b9a0c), color-stop(13%,#89a818), color-stop(91%,#abd026)); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top,  #7b9a0c 1%,#89a818 13%,#abd026 91%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top,  #7b9a0c 1%,#89a818 13%,#abd026 91%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top,  #7b9a0c 1%,#89a818 13%,#abd026 91%); /* IE10+ */
    background: linear-gradient(top,  #7b9a0c 1%,#89a818 13%,#abd026 91%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#7b9a0c', endColorstr='#abd026',GradientType=0 ); /* IE6-9 */
    color:#3a492c;
    border:1px solid #88a462;
    text-decoration:none;
}

ul.avatar_tabs{ list-style:none; margin:0; padding:0; overflow:hidden}
ul.avatar_tabs li{float:left; margin:0 1px 0 0}
ul.avatar_tabs li a{padding:7px 8px 5px 8px;display:block; background:#C1DBE7; color:#555; text-decoration:none; -moz-transition: none; -webkit-transition: none; -o-transition: color 0 ease-in; transition: none;}
ul.avatar_tabs li a:hover{background-color:#BDEAFF; color:#111}
ul.avatar_tabs li a.current{background:#71AECA; color:#fff; padding:7px 13px 5px 13px;}
ul.avatar_tabs li:first-child a{ border-radius:6px 0 0 0;}
ul.avatar_tabs li:last-child a{ border-radius:0 6px 0 0;  padding:7px 13px 5px 14px;}
ul.avatar_tabs li a:focus{outline:0}

button#swap_gender {
    font-size:12px;
    padding:10px 13px 8px;
}
</style>

<div class="success" id="success_container" style="display:none;">
    <h3><?= image('images/icons/yay.png') ?> {compliment}</h3>
    <p>Your avatar has been saved!</p>
</div>

<div id="avatar_preview" style="width:180px; float:left;">
    <img src="{avatar_preview_url}" id="avatar_preview_img" width="180" height="270" />
    <div style="margin:5px 10px;">
        <a href="<?=site_url('avatar/save')?>" id="save_avatar">Save changes</a>
        <div style="text-align:center; margin-right:auto; margin-left:auto;">
            <a href="#" id="revert">Revert</a> or <a href="#" id="unequip_all_button">Unequip all</a>
        </div>
        <div style="text-align:center; margin-right:auto; margin-left:auto; border-top:1px solid #ccc; margin-top:5px; padding-top:3px;">
            <a href="#" id="swap_gender">Swap Gender</a>
        </div>
    </div>
</div>

<div style="margin:0; width:545px; float:left;">
    <div class="tabs">
        <?php if (count($items) > 0): ?>
            <ul class="avatar_tabs">
                <?php foreach ($items as $tab => $tabContent): ?>
                    <li><?= '<a href="#'.strtolower($tab).'" class="'.strtolower($tab).'">'.$tab.'</a>'; ?></li>
                <?php endforeach ?>
            </ul>
            <div id="tab_glove">
            <? $i=0; foreach($items as $tab => $item1): ?>
                <div id="<?= strtolower($tab) ?>" <?php if($i==0){ $i++; echo 'style="display:;"';} ?>>
                <? foreach($item1 as $key_1 => $item3): ?>
                    <? foreach($item3 as $key_2 => $item): ?>
                        <? if(isset($item['sub_items'][0])): ?>
                        <? $sub_active = false; ?>
                            <div class="iitem multi_item" id="<?= $item['group_key']?>">
                                <a href="<?= site_url('avatar/equip/'.$item['id'].'/'.(count($item['sub_items']) > 0 ? '-1' : '')); ?>" class="stack<?= ($item['equipped'] ? ' equipped' : '');?>" layer="<?= $item['layer']?>" id="<?= $item['id']?>" parent="true" style="margin:0.5px;">
                                    <? if($item['num'] > 1):?>
                                        <?= lazy_item_thumb('avatar/thumbnail/'.$item['id'], 'title="'.$item['name'].'"') ?>
                                    <? else: ?>
                                        <?= lazy_item_thumb('/images/items/'.$item['thumb'], 'title="'.$item['name'].'"') ?>
                                    <? endif; ?>
                                    </a>
                                <ul>
                                <? foreach($item['sub_items'] as $sub_item): ?>
                                <? ($sub_item['equipped'] ? $sub_active = true : ''); ?>
                                  <li>
                                      <a href="<?= site_url('avatar/equip/'.$item['id'].'-'.$sub_item['sub_item_key']);?>" class="stack <?= ($sub_item['equipped'] ? 'equipped' : '');?>" layer="<?= $sub_item['layer']?>" id="<?= $item['id']?>" sub_item="true" style="margin:0.5px;">
                                        <?= lazy_item_thumb('images/items/'.$sub_item['thumb'], 'title="'.$sub_item['name'].'"') ?>
                                    </a>
                                  </li>
                                <? endforeach; ?>
                                </ul>
                                <a href="#" class="pull_down <?=($sub_active ? 'glowing' : '')?>" style="margin:7px -3px 0 0;"></a>
                            </div>
                        <? else: ?>
                            <div class="iitem">
                                <a href="<?= site_url('avatar/equip/'.$item['id'].'/');?>" class="stack<?= ($item['equipped'] ? ' equipped' : '');?>" layer="<?= $item['layer']?>"  id="<?= $item['id']?>" style="margin:0.5px;">
                                <? if($item['num'] > 1):?>
                                    <?= lazy_item_thumb('avatar/thumbnail/'.$item['id'].'/'.$item['num'], 'title="'.$item['name'].'"') ?>
                                <? else: ?>
                                    <?= lazy_item_thumb('/images/items/'.$item['thumb'], 'title="'.$item['name'].'"') ?>
                                <? endif; ?>
                                </a>
                            </div>
                        <? endif; ?>
                    <? endforeach; ?>
                <? endforeach; ?>
                <div class="clearfix"></div>
                </div>
            <? endforeach; ?>
            </div>
        <? else: ?>
            <strong>You have no items in your inventory.</strong>
        <? endif; ?>
        <div class="clearfix"></div>
    </div>
</div>

<br clear="all" />
<br />
